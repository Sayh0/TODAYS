<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Today's</title>
</head>
<!-- 파비콘 추가 -->
<link rel="icon" href="/static/images/icon/pavicon.png">

<!-- jQurey -->
<script src="https://code.jquery.com/jquery-latest.min.js" type="application/javascript"></script>

<!-- Bootstrap CSS JS -->
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
<script src="{% static 'js/bootstrap.min.js' %}"></script>

<!-- Link Swiper's CSS JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"/>
<script src="{% static 'js/swiper-bundle.min.js' %}"></script>

<!-- CARD CSS -->
<link rel="stylesheet" type="text/css" href="{% static 'css/card.css' %}">


<style>


.jb-box { width: 60%; height: 100%; overflow: hidden;margin: 0px auto; position: relative; } /*동영상이 정해진 높이를 벗어나면 보이지 않도록 overflow 속성을 정하기*/
video { width: 100%; height: 100%; } /*좌우 꽉차게 하기*/
.dv-text { position: absolute; top: 18%; width: 100%; } /*텍스트가 동영상 위로 올라가도록 하기*/
.dv-text p { margin-top: -50px; text-align: center; font-size: 1vw; color: #ffffff; } /*텍스트 위치를 조정하고, 모양을 정하기*/

.dv-text2 { position: absolute; top: 20%; width: 100%; }
.dv-text2 p { margin-left: 1vw; text-align: left; font-size: 2vw; color: #ffffff; }

.dv-text3 { position: absolute; top: 20%; width: 100%; }
.dv-text3 p { margin-right: 1vw; text-align: right; font-size: 1vw; color: #ffffff; }

.dv-text4 { position: absolute; top: 80%; width: 100%; }
.dv-text4 p { margin-bottom: 1vw; text-align: center; font-size: 1vw; color: #ffffff; }
.btn1 { border : none; background-color : rgba(0,0,0,0);}

.cafe-text p { margin-top: 10vw; text-align: center; font-size: 1vw; color: #ffffff; }




.swiper {
	width: 60%;
    height: 100%;
}

.swiper-slide {
	text-align: center;
	font-size: 18px;
	background: #fff;
}
.swiper-button-next{
	padding: 10px;
	right: 0;
}
.swiper-button-prev{
	left: 0;
}
.swiper-pagination-bullet{
  background-color: #6E93f7;
  opacity: 1;
}
.swiper-pagination-bullet-active{
  background-color: #4070F4;
}

@media screen and (max-width: 768px) {
  .slide-content{
    margin: 0 10px;
  }
  .swiper-navBtn{
    display: none;
  }
}

.fixed{
width: 100%; height: 100%;
background-image: url(/static/images/bg.jpg);
background-repeat: no-repeat; /* 배경이미지X */
background-size: cover; /* 요소를 비율에 맞게 커버 */
background-position: center; /* 이미지를 요소의 정가운데로 처리 */
background-attachment: fixed; /* 스크롤바 움직일때 이미지가 따라다님 */
}

</style>
<script>
const btn1 = () => {
   window.scrollTo({top:1000, behavior:'smooth'});
    }

$("document").ready(function () {
    // 문서의 dom이 준비되면
    // .mySwiper 클래스를 swiper 슬라이더로 만듦
    // 이후에 swiper변수에 할당했기 때문에 스크립트로 제어할 수도 있음.
    var swiper = new Swiper(".mySwiper", {
        slidesPerView: 'auto',
        spaceBetween: 80,
        loop: true,

        // pagination 기본은 bullet
        pagination: {
            el: ".swiper-pagination"
        },


        on: {
            init: function() {
                $('.swiper-slide').addClass('changed');

                // fraction에 현재 인덱스와 전체 인덱스 표시
                // this.loopedSlides는 loop, slidesPerView: 'auto'일 때 제대로 동작
                $('.custom-fraction .current').text(this.realIndex + 1);
                $('.custom-fraction .all').text(this.loopedSlides);
                // console.log(this);
                // console.log(this.loopedSlides)
            },

            slideChangeTransitionStart: function() {
                // 기본적으로 제공하는 swiper-slide-active 클래스를 이용해
                // css transition 애니메이션 작성 가능하다.
                // 다만 루프 모드일 때에는 루프 픽스를 하며 slide를 바꿔치기를 하는데,
                // 이 때 플리커링이 발생할 수 있다.
                // css transition을 서로 다르게 설정한 changed, changing 클래스를 이용
                $('.swiper-slide').addClass('changing');
                $('.swiper-slide').removeClass('changed');

                // 페이지 넘어갈 때마다 fraction 현재 인덱스 변경
                $('.custom-fraction .current').text(this.realIndex + 1);
            },

            slideChangeTransitionEnd: function() {
                // changing : transition O
                // changed : transition X
                $('.swiper-slide').removeClass('changing');
                $('.swiper-slide').addClass('changed');
            }
        },
    });

    // 슬라이더 할당한 swiper로 슬라이더 제어
    $(".auto-start").on("click", function() {
        // 기본 설정으로 autoplay 시작
        console.log("autoplay start");
        swiper.autoplay.start();
    });

    $(".auto-stop").on("click", function() {
        console.log("autoplay stop");
        swiper.autoplay.stop();
    });
});
</script>

<body class="fixed">
<!-- 네비게이션바 -->
{% include "navbar.html" %}
<div class="jb-box">
	<video muted autoplay loop>
		<source src= {{ background }} type="video/mp4">
	</video>
	<div class="dv-text">
		<p>
			현재 {{ dong }}의 날씨 정보입니다.</br>
			풍속은 {{ selected_wsd }}m/s 입니다.</br>
            <!--
            위도 경도는 콘솔창에 표시.
            -->
		</p>
	</div>
	<div class="dv-text2">
		<p>
            {{ gu }} <br />
            {{ dong }} <br />
			<span style="font-size: 6vw;">{{ selected_tmp }}°C</span>
		</p>
	</div>
	<div class="dv-text3">
		<p>
			<strong>이번주 날씨</strong><br />
			월 7°C<br />
			화 3°C<br />
			수 4°C<br />
			목 10°C<br />
			금 11°C<br />
			토 8°C<br />
			일 4°C<br />
		</p>
	</div>
	<div class="dv-text4">
		<p>
			오늘의 추천 카페 보기<br />
			▼
		</p>
	</div>
</div>

<div class="swiper mySwiper">
	<div class="swiper-wrapper">

    {% for i in loop %} <!-- 장고 템플릿 언어로 for 문 생성 --> <!-- views.py의 55 라인 참고 -->
      	<div class="swiper-slide">
			<div class="image-content">
				<span class="overlay"></span>
				<div class="card-image">
					<img src="/static/images/cafe.jpg" alt="" class="card-img">
				</div>
     	 	</div>
			<div class="card-content">
     	 		<h2 class="name">{{ i.name }}</h2>
      			<p class="description">{{ i.addr }}</p>
                {% if 'Members' in request.session %}
                <input type="checkbox" onClick="testfunction(this)" value="{{i.name }}" id="cafe{{ i.num }}" name="checkbox{{ i.num }}">
                {% endif %}
				<button class="button">View More</button>
     		 </div>
      	</div>
    {% endfor %}

    </div>
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-pagination"></div>
</div>
<!-- checkbox value 저장 폼. 추후에 inputType hidden 으로 변경해야 함 -->
<form action="/bookmark/" onsubmit="return checkForm()" name=recommendedCafe" id="recommendedCafe" method="POST">{% csrf_token %}
    {% for i in loop %} <!-- 장고 템플릿 언어로 for 문 생성 -->
    <input type="text" id="cafe{{ i.num }}value" name="cafe{{ i.num }}value" value="">
    {% endfor %}
    <input type="text" id="cafeCnt" name="cafeCnt" value="0">
    {% if 'Members' in request.session %}
    <input type="submit" id="submit" value="북마크 추가">
    {% endif %}
</form>

<script>
    let sum = 0;
    function testfunction(box){
        if(box.checked) { // 체크가 되면 checked==true라는 값을 전달받는다.
            objectValue = box.id + "value";
            document.getElementById(objectValue).value=document.getElementById(box.id).value;
            sum++;
            document.getElementById("cafeCnt").value=parseInt(sum);
        } else if(!box.checked) {
            sum--;
            objectValue = box.id + "value";
            document.getElementById(objectValue).value="";
            document.getElementById("cafeCnt").value=parseInt(sum);
        }
    }
    function checkForm(){
        if (sum == 0) {
            alert("하나 이상 체크하세요");
            return false;
        } else return true;
    }
</script> <!-- 체크박스 제어 함수 -->

<script>
const btn1 = () => {
   window.scrollTo({top:1000, behavior:'smooth'});
    }

$("document").ready(function () {
    // 문서의 dom이 준비되면
    // .mySwiper 클래스를 swiper 슬라이더로 만듦
    // 이후에 swiper변수에 할당했기 때문에 스크립트로 제어할 수도 있음.
    var swiper = new Swiper(".mySwiper", {
        slidesPerView: 'auto',
        spaceBetween: 80,
        loop: true,

        // pagination 기본은 bullet
        pagination: {
            el: ".swiper-pagination"
        },

        // 좌우 화살표 navigation element 지정
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev"
        },
        // 반응형
        breakpoints: {
            // 600px 이하가 되면 슬라이드 간 간격을 0으로
            600: {
                spaceBetween: 0
            },
        },

        on: {
            init: function() {
                $('.swiper-slide').addClass('changed');

                // fraction에 현재 인덱스와 전체 인덱스 표시
                // this.loopedSlides는 loop, slidesPerView: 'auto'일 때 제대로 동작
                $('.custom-fraction .current').text(this.realIndex + 1);
                $('.custom-fraction .all').text(this.loopedSlides);
                // console.log(this);
                // console.log(this.loopedSlides)
            },

            slideChangeTransitionStart: function() {
                // 기본적으로 제공하는 swiper-slide-active 클래스를 이용해
                // css transition 애니메이션 작성 가능하다.
                // 다만 루프 모드일 때에는 루프 픽스를 하며 slide를 바꿔치기를 하는데,
                // 이 때 플리커링이 발생할 수 있다.
                // css transition을 서로 다르게 설정한 changed, changing 클래스를 이용
                $('.swiper-slide').addClass('changing');
                $('.swiper-slide').removeClass('changed');

                // 페이지 넘어갈 때마다 fraction 현재 인덱스 변경
                $('.custom-fraction .current').text(this.realIndex + 1);
            },

            slideChangeTransitionEnd: function() {
                // changing : transition O
                // changed : transition X
                $('.swiper-slide').removeClass('changing');
                $('.swiper-slide').addClass('changed');
            }
        },
    });

    // 슬라이더 할당한 swiper로 슬라이더 제어
    $(".auto-start").on("click", function() {
        // 기본 설정으로 autoplay 시작
        console.log("autoplay start");
        swiper.autoplay.start();
    });

    $(".auto-stop").on("click", function() {
        console.log("autoplay stop");
        swiper.autoplay.stop();
    });
});
</script>

<script>
var swiper = new Swiper(".mySwiper", {
  slidesPerView: 3,
  spaceBetween: 30,
  slidesPerGroup: 3,
  loop: true,
  loopFillGroupWithBlank: true,
  pagination: {
    el: ".swiper-pagination",
    clickable: true,
  },
  navigation: {
    nextEl: ".swiper-button-next",
    prevEl: ".swiper-button-prev",
  },
});

</script>

</body>
</html>